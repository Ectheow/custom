(use-modules (srfi srfi-64)
	     (custom io))

(test-begin "basic-scanline")

(test-equal "hello!"
  (scan-input-for-line
   (lambda (x)
     (equal? x "hello!"))
   (open-input-string
    "one\ntwo\nthree\nhello!\nworld")))
(test-equal #false
  (scan-input-for-line
   (lambda (x)
     (equal? x "hello!"))
   (open-input-string
    "one\ntwo\nthree\nfour\nfive\n")))
(test-equal #false
  (scan-input-for-line
   (lambda (x)
     (equal? x "hello"))
   (subprocess-stdout (fork-and-exec '(sh -c "sleep 3; echo hello!")))
   #:timeout-secs 1))

   
